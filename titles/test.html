<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Testing Title (1997)</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #000;
      color: #fff;
      text-align: center;
    }

    .back-button {
      margin: 20px auto;
      padding: 10px 20px;
      background-color: var(--theme-color);
      color: #fff;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      cursor: pointer;
    }

    .poster {
      width: 220px;
      height: auto;
      margin-top: 10px;
      border-radius: 6px;
    }

    .title {
      font-size: 24px;
      font-weight: bold;
      margin-top: 10px;
    }

    .info {
      font-size: 16px;
      margin-bottom: 20px;
    }

    .prices-heading {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 10px;
      color: var(--theme-color);
      text-shadow: 0 0 10px var(--theme-color);
    }

    .price-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .price-box {
      background-color: #111;
      border: 1px solid var(--theme-color);
      border-radius: 8px;
      padding: 10px 15px;
      min-width: 90px;
      box-shadow: 0 0 10px rgba(255,255,255,0.05);
    }

    .description {
      font-size: 14px;
      padding: 0 20px;
      max-width: 500px;
      margin: 0 auto 30px;
      color: #ccc;
    }
  </style>
</head>
<body>
  <script>
    window.onload = () => {
      const img = new Image();
      img.crossOrigin = "Anonymous";
      img.src = "Testing.png";
      img.onload = function () {
        const canvas = document.createElement("canvas");
        canvas.width = img.width;
        canvas.height = img.height;
        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0);

        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
        const colorMap = new Map();
        let r, g, b;
        let count = 0;

        for (let i = 0; i < imageData.length; i += 4) {
          r = imageData[i];
          g = imageData[i + 1];
          b = imageData[i + 2];

          const brightness = 0.299 * r + 0.587 * g + 0.114 * b;
          const key = `${Math.round(r / 8)},${Math.round(g / 8)},${Math.round(b / 8)}`;

          // Filter out nearly-black/white pixels
          if (brightness > 30 && brightness < 230) {
            const saturation = Math.max(r, g, b) - Math.min(r, g, b);
            if (saturation > 20) {
              count++;
              colorMap.set(key, (colorMap.get(key) || 0) + 1);
            }
          }
        }

        const topColor = [...colorMap.entries()].sort((a, b) => b[1] - a[1])[0]?.[0];
        if (topColor) {
          const [rBin, gBin, bBin] = topColor.split(",").map(n => parseInt(n) * 8);
          const hex = `#${[rBin, gBin, bBin].map(x => x.toString(16).padStart(2, "0")).join("")}`;
          document.documentElement.style.setProperty("--theme-color", hex);
        }
      };
    };
  </script>

  <button class="back-button">← Back to Titles</button>
  <img src="Testing.png" alt="Movie Poster" class="poster" />
  <div class="title">Testing Title (1997)</div>
  <div class="info">Rating: PG • 1997<br>Genre: Horror</div>

  <div class="prices-heading">Current Market Prices</div>
  <div class="price-grid">
    <div class="price-box">Raw: $22</div>
    <div class="price-box">Grade 7.0: $34</div>
    <div class="price-box">Grade 8.0: $48</div>
    <div class="price-box">Grade 9.0: $75</div>
    <div class="price-box">Grade 9.5: $90</div>
    <div class="price-box">Grade 10: $150</div>
  </div>

  <div class="description">
    A chilling tale of a haunted VHS tape that traps its viewers in a looping nightmare.
  </div>
</body>
</html>